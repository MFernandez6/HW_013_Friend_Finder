<!DOCTYPE html>
<html>

<head>
    <title>The 'Friends' Query</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- Link static CSS -->
    <link rel="stylesheet" type="text/css"
        href="/HW_13_Friend_Finder/HW_013_Friend_Finder/FriendFinder/app/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Baloo|Roboto" rel="stylesheet">
</head>

<body>
    <div class="container content">
        <h1>The "Friends" Query</h1>
        <p>Who in the gang will be your best buddy? Hope you're ready to sing "Smelly Cat" with Pheobes! The next few
            quetions will help the algorithm calculate your new best friend. These questions are answered by the numbers
            1 through 5. For example, if you really disagree with the statement, your answer would be 1.</p>
        <form>
            <div class="form-group">
                <input id="name" type="text" class="form-control" placeholder="Name (Required)">
            </div>
            <div class="form-group">
                <input id="photo" type="text" class="form-control" placeholder="Link to Profile Photo (Required)">
            </div>
            <div class="form-group">
                <label for="question1">I like dinasaur fossils.</label>
                <select class="form-control" id="question1">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question2">I can go hours shopping.</label>
                <select class="form-control" id="question2">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question3">I enjoy a neat, clean, organized kitchen cabinet.</label>
                <select class="form-control" id="question3">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question4">I like making music.</label>
                <select class="form-control" id="question4">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question5">I love to eat.</label>
                <select class="form-control" id="question5">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question6">I am funny in awkward moments</label>
                <select class="form-control" id="question6">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question7">I consider myself an actor.</label>
                <select class="form-control" id="question7">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question8">I have a twin.</label>
                <select class="form-control" id="question8">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question9">I love to cook.</label>
                <select class="form-control" id="question9">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question10">I consider myself good-looking.</label>
                <select class="form-control" id="question10">
                    <option value="empty"></option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
        </form>
        <div class="text-center">
            <button id="submitBtn" type="submit" class="btn btn-primary btn-lg">Who's Your New BFF</button>
        </div>

    <footer>
        <div class="container">
            <a href="/api/friends">"Friends" API List</a>
            <span>|</span>
            <a href="https://github.com/MFernandez6/HW_013_Friend_Finder">GH Repository</a>
        </div>
    </footer>
    <!-- Modal after survey completion -->
    <div id="resultsModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        &times;
                    </button>
                    <h2 class="modal-title"><strong>Best Match</strong></h2>
                </div>

                <div class="modal-body">
                    <h2 id="matchName"></h2>
                    <img
                        id="matchImg"
                        src="https://via.placeholder.com/400x400"
                        alt="Placeholder image in case user pic doesn't show"
                    />
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        Close
                    </button>
                </div>
            </div>


        </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</body>

</html>
<script type="text/javascript">
    $("#submitBtn").on("click", function (event) {
        event.preventDefault();
        function validateForm() {
            var isValid = true;
            $(".form-control").each(function() {
                if ($(this).val() === "") isValid = false;
            });
            $(".chosen-select").each(function() {
                if ($(this).val() === "") isValid = false;
            });
            return isValid;
        }
        if(validateForm() === true){
            var userData = {
                name: $("#name").val(),
                photo: $("#photo").val().trim(),
                scores: [
                    $("#question1").val(),
                    $("#question2").val(),
                    $("#question3").val(),
                    $("#question4").val(),
                    $("#question5").val(),
                    $("#question6").val(),
                    $("#question7").val(),
                    $("#question8").val(),
                    $("#question9").val(),
                    $("#question10").val()
                ]
            };
            var currentURL = window.location.origin;

            // Ajax call for receiving response after POST req
            $.post(currentURL + "/api/friends", userData, function (data) {
                $("#matchName").text(data.name);
                $("#matchImg").attr("src", data.photo);
                $("#resultsModal").modal("toggle");
            });
        } else {
            // If a required field is missing, show alert
            alert("Survey is incomplete!");
        }
    });
</script>